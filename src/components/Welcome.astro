---
const apiKey = import.meta.env.VITE_WP_KEY;
const apiUrl = "https://admin.janvanerkel.nl/wp-json/wp/v2/posts";

let posts = [];
let error = null;

try {
	const response = await fetch(apiUrl, {
		headers: {
			'X-API-KEY': apiKey, // Gebruik de juiste header zoals in je WordPress plugin
		},
	});

	if (response.ok) {
		posts = await response.json();
	} else {
		error = `Fout bij het ophalen van posts: ${response.status}`;
	}
} catch (e) {
	error = `Fout bij de fetch-aanroep: ${e.message}`;
}
---
<html>
<head>
	<title>Blog Posts</title>
</head>
<body>
<h1>Recent Posts</h1>
{error ? (
	<p>{error}</p>
) : (
	<ul>
		{posts.length > 0 ? (
			posts.map((post) => (
				<li key={post.id}>
					<h2>{post.title.rendered}</h2>
					<p dangerouslySetInnerHTML={{ __html: post.excerpt.rendered }}></p>
					<a href={post.link}>Lees meer</a>
				</li>
			))
		) : (
			<li>Geen berichten gevonden</li>
		)}
	</ul>
)}
</body>
</html>